---
title: クロスリファレンス
sidebar_position: 7
image: og/docs/howto.jpg
---

import CrossReferencePerformanceNote from '/_includes/cross-reference-performance-note.mdx';

<CrossReferencePerformanceNote />

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import FilteredTextBlock from '@site/src/components/Documentation/FilteredTextBlock';
import PyCode from '!!raw-loader!/_includes/code/howto/manage-data.cross-refs.py';
import PyCodeV3 from '!!raw-loader!/_includes/code/howto/manage-data.cross-refs-v3.py';
import TSCode from '!!raw-loader!/_includes/code/howto/manage-data.cross-refs.ts';
import TSCodeLegacy from '!!raw-loader!/_includes/code/howto/manage-data.cross-refs-v2.ts';
import JavaCode from '!!raw-loader!/_includes/code/howto/java/src/test/java/io/weaviate/docs/manage-data.cross-refs.java';
import GoCode from '!!raw-loader!/_includes/code/howto/go/docs/manage-data.cross-refs_test.go';
import SkipLink from '/src/components/SkipValidationLink'


クロスリファレンスを使用して、コレクション間に方向性のあるリレーションシップを確立します。

<details>
  <summary>
    追加情報
  </summary>

注記:
- クロスリファレンスは、ソースまたはターゲットオブジェクトのオブジェクト ベクトルには影響しません。
- マルチテナンシ コレクションでは、次のいずれかに対してクロスリファレンスを設定できます:
    - マルチテナンシでないコレクション オブジェクト
    - 同じテナントに属するマルチテナンシ コレクション オブジェクト

</details>

## クロスリファレンス プロパティの定義

クロスリファレンスを追加する前に、その参照プロパティをコレクション定義に含めておきます。

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START CrossRefDefinition"
      endMarker="# END CrossRefDefinition"
      language="py"
    />
  </TabItem>
  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# START CrossRefDefinition"
      endMarker="# END CrossRefDefinition"
      language="pyv3"
    />
  </TabItem>
  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// START CrossRefDefinition"
      endMarker="// END CrossRefDefinition"
      language="ts"
    />
  </TabItem>
</Tabs>

## クロスリファレンス プロパティの追加

既存のコレクション定義にクロスリファレンス プロパティを追加することもできます。

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START Collections TwoWay Category2"
      endMarker="# END Collections TwoWay Category2"
      language="python"
    />
  </TabItem>
  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# START Collections TwoWay Category2"
      endMarker="# END Collections TwoWay Category2"
      language="pyv3"
    />
  </TabItem>
  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// START Collections TwoWay Category2"
      endMarker="// END Collections TwoWay Category2"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// START Collections TwoWay Category2"
      endMarker="// END Collections TwoWay Category2"
      language="tsv2"
    />
  </TabItem>
</Tabs>


## クロスリファレンス付きオブジェクトの作成

オブジェクトを作成する際にクロスリファレンスを指定します。

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START ObjectWithCrossRef"
      endMarker="# END ObjectWithCrossRef"
      language="py"
    />
  </TabItem>

  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# START ObjectWithCrossRef"
      endMarker="# END ObjectWithCrossRef"
      language="pyv3"
    />
  </TabItem>

  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// START ObjectWithCrossRef"
      endMarker="// END ObjectWithCrossRef"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// START ObjectWithCrossRef"
      endMarker="// END ObjectWithCrossRef"
      language="tsv2"
    />
  </TabItem>
</Tabs>




## 一方向クロスリファレンスの追加

ソースとターゲットの必須 id とプロパティを指定します。

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START OneWay"
      endMarker="# END OneWay"
      language="py"
    />
  </TabItem>

  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# START OneWay"
      endMarker="# END OneWay"
      language="pyv3"
    />
  </TabItem>

  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// START OneWay"
      endMarker="// END OneWay"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// START OneWay"
      endMarker="// END OneWay"
      language="tsv2"
    />
  </TabItem>

  <TabItem value="java" label="Java">
    <FilteredTextBlock
      text={JavaCode}
      startMarker="// START OneWay"
      endMarker="// END OneWay"
      language="java"
    />
  </TabItem>

  <TabItem value="go" label="Go">
    <FilteredTextBlock
      text={GoCode}
      startMarker="// START OneWay"
      endMarker="// END OneWay"
      language="go"
    />
  </TabItem>
</Tabs>


## 双方向クロスリファレンスの追加

これは、両方向にリファレンスプロパティを追加し、オブジェクトペアごとに 2 つのクロスリファレンス（ `from` A -> `to` B と `from` B -> `to` A）を追加する必要があります。

`JeopardyCategory` コレクションを作成します:

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START Collections TwoWay Category1"
      endMarker="# END Collections TwoWay Category1"
      language="python"
    />
  </TabItem>
  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# START Collections TwoWay Category1"
      endMarker="# END Collections TwoWay Category1"
      language="pyv3"
    />
  </TabItem>
  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// START Collections TwoWay Category1"
      endMarker="// END Collections TwoWay Category1"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// START Collections TwoWay Category1"
      endMarker="// END Collections TwoWay Category1"
      language="tsv2"
    />
  </TabItem>
</Tabs>

`JeopardyQuestion` コレクションを作成し、 `JeopardyCategory` へのリファレンスプロパティを含めます:

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START Collections TwoWay Question"
      endMarker="# END Collections TwoWay Question"
      language="python"
    />
  </TabItem>
  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# START Collections TwoWay Question"
      endMarker="# END Collections TwoWay Question"
      language="pyv3"
    />
  </TabItem>
  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// START Collections TwoWay Question"
      endMarker="// END Collections TwoWay Question"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// START Collections TwoWay Question"
      endMarker="// END Collections TwoWay Question"
      language="tsv2"
    />
  </TabItem>
</Tabs>

`JeopardyCategory` を修正し、 `JeopardyQuestion` へのリファレンスを追加します:

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# START Collections TwoWay Category2"
      endMarker="# END Collections TwoWay Category2"
      language="python"
    />
  </TabItem>
  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# START Collections TwoWay Category2"
      endMarker="# END Collections TwoWay Category2"
      language="pyv3"
    />
  </TabItem>
  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// START Collections TwoWay Category2"
      endMarker="// END Collections TwoWay Category2"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// START Collections TwoWay Category2"
      endMarker="// END Collections TwoWay Category2"
      language="tsv2"
    />
  </TabItem>
</Tabs>

そしてクロスリファレンスを追加します:

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# TwoWay Python"
      endMarker="# END TwoWay Python"
      language="py"
    />
  </TabItem>

  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# TwoWay Python"
      endMarker="# END TwoWay Python"
      language="pyv3"
    />
  </TabItem>

  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// TwoWay TS"
      endMarker="// END TwoWay TS"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// TwoWay TS"
      endMarker="// END TwoWay TS"
      language="tsv2"
    />
  </TabItem>

  <TabItem value="java" label="Java">
    <FilteredTextBlock
      text={JavaCode}
      startMarker="// TwoWay Java"
      endMarker="// END TwoWay Java"
      language="java"
    />
  </TabItem>

  <TabItem value="go" label="Go">
    <FilteredTextBlock
      text={GoCode}
      startMarker="// TwoWay Go"
      endMarker="// END TwoWay Go"
      language="go"
    />
  </TabItem>
</Tabs>





## 複数 (一対多) のクロスリファレンスを追加

Weaviate では、1 つのソースオブジェクトから複数のクロスリファレンスを作成できます。

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# Multiple Python"
      endMarker="# END Multiple Python"
      language="py"
    />
  </TabItem>

  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# Multiple Python"
      endMarker="# END Multiple Python"
      language="pyv3"
    />
  </TabItem>

  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// Multiple TS"
      endMarker="// END Multiple TS"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// Multiple TS"
      endMarker="// END Multiple TS"
      language="tsv2"
    />
  </TabItem>

  <TabItem value="java" label="Java">
    <FilteredTextBlock
      text={JavaCode}
      startMarker="// Multiple Java"
      endMarker="// END Multiple Java"
      language="java"
    />
  </TabItem>

  <TabItem value="go" label="Go">
    <FilteredTextBlock
      text={GoCode}
      startMarker="// Multiple Go"
      endMarker="// END Multiple Go"
      language="go"
    />
  </TabItem>
</Tabs>

## クロスリファレンスの読み取り

クロスリファレンスはオブジェクトの一部として読み取ることができます。

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# ReadCrossRef"
      endMarker="# END ReadCrossRef"
      language="py"
    />
  </TabItem>

  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# ReadCrossRef"
      endMarker="# END ReadCrossRef"
      language="pyv3"
    />
  </TabItem>

  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// ReadCrossRef"
      endMarker="// END ReadCrossRef"
      language="ts"
    />
  </TabItem>
</Tabs>

## クロスリファレンスの削除

クロスリファレンスを定義したときと同じパラメーターを使用してクロスリファレンスを削除します。

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# Delete Python"
      endMarker="# END Delete Python"
      language="py"
    />
  </TabItem>

  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# Delete Python"
      endMarker="# END Delete Python"
      language="pyv3"
    />
  </TabItem>

  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// Delete TS"
      endMarker="// END Delete TS"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// Delete TS"
      endMarker="// END Delete TS"
      language="tsv2"
    />
  </TabItem>

  <TabItem value="java" label="Java">
    <FilteredTextBlock
      text={JavaCode}
      startMarker="// Delete Java"
      endMarker="// END Delete Java"
      language="java"
    />
  </TabItem>

  <TabItem value="go" label="Go">
    <FilteredTextBlock
      text={GoCode}
      startMarker="// Delete Go"
      endMarker="// END Delete Go"
      language="go"
    />
  </TabItem>
</Tabs>

<details>
  <summary>
    ターゲットオブジェクトが削除された場合はどうなりますか？
  </summary>

`to` オブジェクトが削除された場合はどうなりますか？  
オブジェクトが削除されても、それへのクロスリファレンスはそのまま残ります。[インラインフラグメント構文を使用した Get クエリ](../search/basics.md#retrieve-cross-referenced-properties)は、既存のクロスリファレンスオブジェクトに含まれるフィールドのみを正しく取得しますが、[ID でオブジェクトを取得](../manage-objects/read.mdx#get-an-object-by-id)した場合は、参照先のオブジェクトが存在するかどうかに関係なく、すべてのクロスリファレンスが表示されます。

</details>

## クロスリファレンスの更新

クロスリファレンスのターゲットは更新できます。

<Tabs groupId="languages">
  <TabItem value="py" label="Python Client v4">
    <FilteredTextBlock
      text={PyCode}
      startMarker="# Update Python"
      endMarker="# END Update Python"
      language="py"
    />
  </TabItem>

  <TabItem value="py3" label="Python Client v3">
    <FilteredTextBlock
      text={PyCodeV3}
      startMarker="# Update Python"
      endMarker="# END Update Python"
      language="pyv3"
    />
  </TabItem>

  <TabItem value="js" label="JS/TS Client v3">
    <FilteredTextBlock
      text={TSCode}
      startMarker="// Update TS"
      endMarker="// END Update TS"
      language="ts"
    />
  </TabItem>

  <TabItem value="js2" label="JS/TS Client v2">
    <FilteredTextBlock
      text={TSCodeLegacy}
      startMarker="// Update TS"
      endMarker="// END Update TS"
      language="tsv2"
    />
  </TabItem>

  <TabItem value="java" label="Java">
    <FilteredTextBlock
      text={JavaCode}
      startMarker="// Update Java"
      endMarker="// END Update Java"
      language="java"
    />
  </TabItem>

  <TabItem value="go" label="Go">
    <FilteredTextBlock
      text={GoCode}
      startMarker="// Update Go"
      endMarker="// END Update Go"
      language="go"
    />
  </TabItem>
</Tabs>


## 関連ページ

- [Weaviate に接続](/weaviate/connections/index.mdx)
- <SkipLink href="/weaviate/api/rest#tag/objects">リファレンス: REST - /v1/objects</SkipLink>
- [クエリの一部としてクロスリファレンスを取得](../search/basics.md#retrieve-cross-referenced-properties)

## 質問とフィードバック

import DocsFeedback from '/_includes/docs-feedback.mdx';

<DocsFeedback/>

