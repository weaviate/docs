### ベクトル埋め込み

ベクトル埋め込みとは、高次元空間におけるオブジェクトの数値表現です。これらのベクトルは、オブジェクトの意味を捉えるように訓練されたモデルによって生成されます。

ベクトル埋め込みは次のようになります:

```json
[0, 1, 0, 0, 1]
```

または次のようになります:

```json
[0.158, 0.011, 0.840, 0.577, 0.897, ..., 0.144]
```

ベクトル埋め込みは一般的に 300 から 2048 次元の間ですが、正確な次元数はモデルによって異なります。ベクトルが長いほど、オブジェクトについてより多くの情報を保持できます。しかしその一方で、保存・インデックス作成・検索に必要なリソースも増えます。

同じモデルから生成されたベクトル埋め込みは「互換性がある」あるいは「同じベクトル空間にある」と言われます。

:::tip 類推: 言語としてのベクトル埋め込み
ベクトル埋め込みを直感的に理解する方法として、言語にたとえることができます。 2 人が意思疎通するには同じ言語を話す必要があるのと同様に、 2 つのベクトルを比較するには同じベクトル空間に属している必要があります。同じベクトル空間にない場合、たとえ長さが同じでも、それらの値を比較しても意味がありません。
:::

## ベクトル距離

ベクトル距離は、高次元空間において 2 つのベクトルがどれだけ近いか、または離れているかを示します。これは、ベクトル埋め込みに基づいて、オブジェクトがクエリと「意味的」にどれだけ類似しているかを測る指標です。

簡単な例として、色「SkyBlue」「LightSteelBlue」「DarkOrange」を考えてみましょう。これらの色は、RGB の値を成分とする 3 次元空間のベクトルとして表現できます。

| 色              | ベクトル (R,G,B) |
|-----------------|------------------|
| SkyBlue         | (135, 206, 235)  |
| LightSteelBlue  | (176, 196, 222)  |
| DarkOrange      | (255, 140, 0)    |

「SkyBlue」と「LightSteelBlue」のベクトルは、「DarkOrange」のベクトルより互いにずっと近く、これは淡い青色同士とオレンジ色との差を反映しています。

ベクトルデータベースに「SkyBlue」と「DarkOrange」のベクトルが保存されている場合、「LightSteelBlue」のクエリベクトルで検索すると、最も近い結果として「SkyBlue」が返されます。

テキスト・画像・音声など、より複雑なオブジェクトに対するベクトル検索も同じ原理で動作します。オブジェクトを高次元空間で表現するように訓練されたモデルがベクトルを生成し、ベクトル間の距離がオブジェクト同士の類似度を表します。

### 距離と検索品質

互換性のあるベクトルは、程度の差はあれどれも互いに似ているため、クエリがデータセット内のオブジェクトとあまり似ていなくても検索結果の「上位」が返ってきます。

「Red」「Crimson」「LightCoral」のベクトルだけが格納されたデータベースに「SkyBlue」のクエリベクトルで検索しても、検索は（たとえば「Red」といった）結果を返します。これはクエリと意味的に似ていなくても、相対的に最も近いベクトルを返すだけだからです。

検索結果を有意義なものにするために、次のような対策を検討してください:

- **しきい値を設定する**: 結果に対して最小の類似度スコアを設け、クエリと十分に似ていない結果を除外します。  
- **フィルターを適用する**: [フィルター](../filtering.md) を使用して、メタデータやプロパティなど他の条件に基づいて結果を除外します。