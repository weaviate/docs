---
title: 準備
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import FilteredTextBlock from '@site/src/components/Documentation/FilteredTextBlock';
import PyCode from '!!raw-loader!../_snippets/101_connect.py';

:::info 前提条件
このコースは単独でも完結しています。しかし、[テキスト](../../starter_text_data/index.md)、[独自ベクトル](../../starter_custom_vectors/index.md)、または[マルチモーダル データ](../../starter_multimodal_data/index.md) を扱う 101 レベルのいずれかのコースを先に受講することをおすすめします。
:::

このページでは、必要なリソースとセットアップ手順について簡単に説明します。具体的には、Weaviate Python クライアント ライブラリと、マルチモーダル ベクトライザーを搭載した Weaviate インスタンスを準備します。

## <i class="fa-solid fa-code"></i> Weaviate Python クライアント ライブラリ

最新の（`v4` 例: `4.5.0`）Weaviate Python クライアント ライブラリを次のコマンドでインストールします:

```bash
pip install -U weaviate-client
```

## <i class="fa-solid fa-chalkboard"></i> Weaviate をセットアップ

マシンに Docker をインストールします。公式の [Docker インストール ガイド](https://docs.docker.com/get-docker/) に従うことをおすすめします。

新しいディレクトリを作成し、ターミナルでそのディレクトリに移動します。次に、`docker-compose.yml` というファイルを作成し、以下の内容を追加します:

```yaml
---
services:
  weaviate:
    command:
    - --host
    - 0.0.0.0
    - --port
    - '8080'
    - --scheme
    - http
    image: cr.weaviate.io/semitechnologies/weaviate:||site.weaviate_version||
    ports:
    - 8080:8080
    - 50051:50051
    volumes:
    - weaviate_data:/var/lib/weaviate
    restart: on-failure:0
    environment:
      CLIP_INFERENCE_API: 'http://multi2vec-clip:8080'
      QUERY_DEFAULTS_LIMIT: 25
      AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED: 'true'
      PERSISTENCE_DATA_PATH: '/var/lib/weaviate'
      ENABLE_MODULES: 'multi2vec-clip'
      ENABLE_API_BASED_MODULES: 'true'
      CLUSTER_HOSTNAME: 'node1'
  multi2vec-clip:
    image: cr.weaviate.io/semitechnologies/multi2vec-clip:sentence-transformers-clip-ViT-B-32-multilingual-v1
    environment:
      ENABLE_CUDA: '0'
volumes:
  weaviate_data:
...

```

### <i class="fa-solid fa-chalkboard"></i> Weaviate インスタンスを作成

次のコマンドを実行して Weaviate を起動します:

```bash
docker compose up
```

### <i class="fa-solid fa-chalkboard"></i> Weaviate インスタンスの詳細

インスタンスが作成されると、`http://localhost:8080` でアクセスできます。

## <i class="fa-solid fa-code"></i> Weaviate を操作する

### <i class="fa-solid fa-code"></i> Weaviate インスタンスへ接続

Weaviate インスタンスへ接続するには、`connect_to_local` 関数を使用します。ここでは、Weaviate が利用する推論 API（例: OpenAI、Cohere、Google、AWS など）の API キーも設定します。

<FilteredTextBlock
  text={PyCode}
  startMarker="# DockerAPIKeyInstantiation"
  endMarker="# END DockerAPIKeyInstantiation"
  language="py"
/>

### <i class="fa-solid fa-code"></i> Weaviate のステータスを確認

`is_live` 関数を使って、Weaviate インスタンスが起動しているかどうかを確認できます。

<FilteredTextBlock
  text={PyCode}
  startMarker="# PollLiveness"
  endMarker="# END PollLiveness"
  language="py"
/>

### <i class="fa-solid fa-code"></i> サーバーのメタ情報を取得

`meta` 関数を使用して、Weaviate インスタンスのメタ情報を取得できます。

<FilteredTextBlock
  text={PyCode}
  startMarker="# GetMeta"
  endMarker="# END GetMeta"
  language="py"
/>

このコマンドを実行すると、サーバーのメタ情報がコンソールに表示されます。出力は次のようになります:

<details>
  <summary>例 <code>get_meta</code> 出力</summary>

CLIP モデルに関する追加情報が含まれるため、出力は少し長くなります。

<FilteredTextBlock
  text={PyCode}
  startMarker="# OutputGetMeta"
  endMarker="# END OutputGetMeta"
  language="py"
/>
</details>

### <i class="fa-solid fa-code"></i> 接続を閉じる

Weaviate クライアントの使用が終わったら、接続を閉じてください。これによりリソースが解放され、接続が適切に終了します。

ベストプラクティスとして、`try`-`finally` ブロックを使用することを推奨します。簡潔さのため、以降のコード スニペットでは `try`-`finally` ブロックを省略します。

<FilteredTextBlock
  text={PyCode}
  startMarker="# TryFinallyCloseDemo"
  endMarker="# END TryFinallyCloseDemo"
  language="py"
/>

## <i class="fa-solid fa-chalkboard"></i> ソース データ

今回は、[TMDB](https://www.themoviedb.org/) から取得した映画データセットを使用します。データセットはこの [GitHub リポジトリ](https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/movies_data_1990_2024.json) にあり、1990 年から 2024 年までに公開された約 700 本の映画に関する書誌情報が含まれています。

マルチモーダル プロジェクトとして、同じリポジトリにある[各映画のポスター](https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/movies_data_1990_2024_posters.zip) も使用します。

<details>
  <summary>サンプル テキスト データを見る</summary>

|    | backdrop_path                    | genre_ids       |   id | original_language   | original_title              | overview                                                                                                                                                                                                                                                                                                                                                                                                                        |   popularity | poster_path                      | release_date   | title                       | video   |   vote_average |   vote_count |
|---:|:---------------------------------|:----------------|-----:|:--------------------|:----------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------:|:---------------------------------|:---------------|:----------------------------|:--------|---------------:|-------------:|
|  0 | /3Nn5BOM1EVw1IYrv6MsbOS6N1Ol.jpg | [14, 18, 10749] |  162 | en                  | Edward Scissorhands         | A small suburban town receives a visit from a castaway unfinished science experiment named Edward.                                                                                                                                                                                                                                                                                                                              |       45.694 | /1RFIbuW9Z3eN9Oxw2KaQG5DfLmD.jpg | 1990-12-07     | Edward Scissorhands         | False   |            7.7 |        12305 |
|  1 | /sw7mordbZxgITU877yTpZCud90M.jpg | [18, 80]        |  769 | en                  | GoodFellas                  | The true story of Henry Hill, a half-Irish, half-Sicilian Brooklyn kid who is adopted by neighbourhood gangsters at an early age and climbs the ranks of a Mafia family under the guidance of Jimmy Conway.                                                                                                                                                                                                                     |       57.228 | /aKuFiU82s5ISJpGZp7YkIr3kCUd.jpg | 1990-09-12     | GoodFellas                  | False   |            8.5 |        12106 |
|  2 | /6uLhSLXzB1ooJ3522ydrBZ2Hh0W.jpg | [35, 10751]     |  771 | en                  | Home Alone                  | Eight-year-old Kevin McCallister makes the most of the situation after his family unwittingly leaves him behind when they go on Christmas vacation. But when a pair of bungling burglars set their sights on Kevin's house, the plucky kid stands ready to defend his territory. By planting booby traps galore, adorably mischievous Kevin stands his ground as his frantic mother attempts to race home before Christmas Day. |        3.538 | /onTSipZ8R3bliBdKfPtsDuHTdlL.jpg | 1990-11-16     | Home Alone                  | False   |            7.4 |        10599 |
|  3 | /vKp3NvqBkcjHkCHSGi6EbcP7g4J.jpg | [12, 35, 878]   |  196 | en                  | Back to the Future Part III | The final installment of the Back to the Future trilogy finds Marty digging the trusty DeLorean out of a mineshaft and looking for Doc in the Wild West of 1885. But when their time machine breaks down, the travelers are stranded in a land of spurs. More problems arise when Doc falls for pretty schoolteacher Clara Clayton, and Marty tangles with Buford Tannen.                                                       |       28.896 | /crzoVQnMzIrRfHtQw0tLBirNfVg.jpg | 1990-05-25     | Back to the Future Part III | False   |            7.5 |         9918 |
|  4 | /3tuWpnCTe14zZZPt6sI1W9ByOXx.jpg | [35, 10749]     |  114 | en                  | Pretty Woman                | When a millionaire wheeler-dealer enters a business contract with a Hollywood hooker Vivian Ward, he loses his heart in the bargain.                                                                                                                                                                                                                                                                                            |       97.953 | /hVHUfT801LQATGd26VPzhorIYza.jpg | 1990-03-23     | Pretty Woman                | False   |            7.5 |         7671 |

</details>
## 質問とフィードバック

import DocsFeedback from '/_includes/docs-feedback.mdx';

<DocsFeedback/>