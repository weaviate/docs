---
title: ベクトル検索の概要
sidebar_position: 20
---

## <i class="fa-solid fa-square-chevron-right"></i> ベクトル検索について

:::warning TODO
導入動画はこちら
:::

### ベクトル検索はどのように機能しますか？

![](../../tmp_images/person_holding_a_magnifying_glass_in_front_of_a_big_pile_of_numbers_1.jpg)

先ほど、ベクトルは単語の意味を表現できると述べました。また別のセクションでは、ベクトル検索が類似度ベースの検索を行う優れた方法であることも触れました。

これら 2 つのアイデアがどのように交差するか、もうお分かりでしょう。ベクトル検索は、意味の数値表現を利用して類似度ベースの検索を行います。2 つのベクトルが互いに近いほど、それらが表す単語の意味も似ています。

そのため、ベクトル検索ではベクトルベースのクエリオブジェクトをベクトルインデックスに渡し、インデックスはクエリオブジェクトに最も似た結果のリストを返します。

ベクトルインデックスは、テキストや画像などのオブジェクトを入力として受け取り、それをベクトルに変換する場合もあれば、クエリオブジェクトとして直接ベクトルを受け取る場合もあります。

### ベクトル類似度はどのように測定されますか？

![](../../tmp_images/scale_of_justice_with_words_on_either_side_0.jpg)

大まかに言うと、ベクトル類似度は各ベクトルを構成する数値の 2 組がどれだけ近いかを測定します。線形代数に詳しくない場合は、やや抽象的に聞こえるかもしれません。

しかし直感的には、2 つのベクトルが近いほど、それらが表す単語の意味も似ているということです。

実際には、ベクトル類似度を測定する方法は数多くあります。代表的な手法には次のようなものがあります。  
- コサイン類似度  
- ユークリッド距離  
- ドット積  
- マンハッタン距離  

どの類似度指標を使うかはユースケースやモデルによって異なります。Weaviate では、特に指定がない限りデフォルトの指標は `cosine similarity` です。これらの選択肢については別のセクションで詳しく扱います。

## <i class="fa-solid fa-square-chevron-right"></i> セマンティック検索とレキシカル検索

:::warning TODO
導入動画はこちら
:::

### セマンティック検索とは？

![](../../tmp_images/confused_people_looking_at_two_similar_piles_of_documents__1.jpg)

「セマンティック」とは「意味に関連する」という意味です。言語学では「構文的 (syntactic)」—構造や文法に関する—と対比して使われます。したがって「セマンティック検索」とは、意味に基づいて行う検索を指します。

現在、セマンティック検索を行う主流の方法がベクトル検索です。ベクトルは単語、文、さらには文書全体の意味を効率的かつ高精度で捉えられるため、セマンティック検索に最適です。

「セマンティック検索」は、画像・音声・動画など他のメディアで表現される概念の類似度を探す検索を指す場合もあります。後ほど詳しく説明しますが、これらのメディアタイプでは、描写されている概念・オブジェクト・トーンといった特定の側面を比較します。

本コースでは特に断りがない限り、「セマンティック検索」と「ベクトル検索」を同義で用います。

### レキシカル検索とは？

![](../../tmp_images/person_holding_a_magnifying_glass_in_front_of_a_big_pile_of_words_1.jpg)

従来の検索システムは「レキシカル (lexical)」検索、つまりシステムやデータベースの「語彙」に基づく検索を採用してきました。

レキシカル検索は、文字列や部分文字列を正確にマッチさせ、各種演算子を用いて条件を満たす／満たさない情報セットを操作します。

例えば、レシピデータベースから材料に「chili」を含むオブジェクトを取得するのはレキシカル検索です。通常は複数の条件を組み合わせます。次のクエリは「chili」を含み、かつ 2010 年以降に追加されたエントリを検索します。

```sql
SELECT * FROM recipe_table WHERE (ingredients LIKE '%chili%') AND (entry_year > 2010)
```

この問い合わせは正確な答えを返しますが、柔軟性に欠けるという欠点があります。

たとえば、同義語である `ghost pepper` が使われているレシピは取得できません。また、エントリが `chilli` と誤綴りされていた場合など、タイプミスにも弱いです。

一方、セマンティック検索はこれらの問題をよりきめ細かく扱えます。

:::note Jargon ("lexical", "semantic", "syntactic")
専門用語は可能な限り避けていますが、必要な場合は説明を添えます。

ベクトル検索は *natural language processing* の分野に起源を持つため、*lexical* や *semantic* といった言語学由来の用語がよく使われます。*vector* は数学の世界から来た言葉です。🤓
:::

### ベクトル検索とレキシカル検索の比較

![](../../tmp_images/person_holding_a_magnifying_glass_in_front_of_a_big_pile_of_numbers_1.jpg)
![](../../tmp_images/person_holding_a_magnifying_glass_in_front_of_a_big_pile_of_words_1.jpg)

レシピデータベースに対して材料 `chili` で検索した場合、レキシカル検索はデータ内にその単語が正確に含まれるエンティティのみを返します。

一方、ベクトル検索では `ghost pepper`、`jalapeno`、`habanero`、`carolina reaper` など、意味的に関連する用語を含むエンティティも結果に含めます。これらはレキシカル検索では無視されます。

さらに、最新のベクトル検索は単語が文中で持つコンテキストも考慮します。例えば、レシピがこれらの材料を「使用する」場合と「使用しない」よう指示している場合とを区別できます。

加えて、ベクトルデータベースはクエリと各結果との類似度を数値化できます。そのため、類似度という意味のある指標で結果をランキングでき、より関連性の高い結果を早く見つけやすくなります。

<Quiz questions={lexicalSearch} />

<Quiz questions={vectorSearchMethod} />

## <i class="fa-solid fa-square-chevron-right"></i> 復習

:::warning TODO
動画はこちら
:::

### <i class="fa-solid fa-pen-to-square"></i> 復習課題

あなた自身の言葉で、XXX を説明してみてください。

:::warning TODO
ユーザーが回答を入力し、類似度スコアと公式の定義を受け取れる入力ボックス？
??
:::

### <i class="fa-solid fa-lightbulb-on"></i> 重要ポイント

:::info
要約を追加
:::

import Quiz from '/src/components/Academy/quiz.js'