---
title: Get{} オブジェクト
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import FilteredTextBlock from '@site/src/components/Documentation/FilteredTextBlock';
import PythonCodeExample from '!!raw-loader!./_snippets/10_get.py';

:::info Weaviate Academy 準備を完了してください
このユニットを始める前に、必ず [Weaviate Academy Preparation](../setup.mdx) ミニユニットを完了し、クライアントライブラリを実行してデモ  Weaviate  インスタンスに問題なく接続できることを確認してください。  
<p><br/></p>

以下のコードスニペットにはクライアントのインスタンス化部分が含まれていません。実行前に、下記の例のようにクライアントをインスタンス化してください。

<Tabs groupId="languages">
<TabItem value="py" label="Python">
<FilteredTextBlock
  text={PythonCodeExample}
  startMarker="# ===== Instantiate to edu-demo with OpenAI ====="
  endMarker="# ===== END Instantiate to edu-demo with OpenAI ====="
  language="py"
/>
</TabItem>
</Tabs>
:::

## <i class="fa-solid fa-square-chevron-right"></i> 概要

import ReactPlayer from 'react-player/lazy'

<ReactPlayer className="react-player" url='https://youtu.be/q2UuBIJVLEM' controls='true'/>
<br/>

## <i class="fa-solid fa-square-chevron-right"></i> `Get` クエリについて

多くのユースケースにおいて、  Weaviate  インスタンスからオブジェクトを取得することは最も一般的な操作となります。

例えば、入力クエリに最も関連する複数の文章を取得したり、ある画像に最も類似した画像を取得したりできます。さらに、特定の文章に最も合致する画像セットを取得することも可能です。

 Weaviate  では、このようなオブジェクト取得操作を `Get` 関数で実行します。

### <i class="fa-solid fa-chalkboard"></i> `Get` 関数の構文

基本的な `Get` 関数は次のようになります。

import GetSyntax from './_snippets/academy.queries.get.syntax.mdx';

<GetSyntax/>

- `Class` フィールドは取得対象オブジェクトのクラス名を指定します。  
- `arguments` 引数はオブジェクトを検索する際の条件を指定します。  
- `properties` 引数は取得したいオブジェクトのプロパティを指定し、`_additional` プロパティも含めることができます。  

それでは、具体的な `Get` クエリを試してみましょう。

## <i class="fa-solid fa-square-chevron-right"></i> スタandalone `Get` クエリ

基本的なスタンドアロンの `Get` クエリは次のようになります。

### <i class="fa-solid fa-code"></i> 例

import GetStandalone from './_snippets/academy.queries.get.standalone.mdx';

<GetStandalone/>

<Tabs groupId="languages">
<TabItem value="py" label="Python">
<FilteredTextBlock
  text={PythonCodeExample}
  startMarker="# ===== GET STANDALONE PYTHON ====="
  endMarker="# ===== END GET STANDALONE PYTHON ====="
  language="py"
/>
</TabItem>
<TabItem value="graphql" label="GraphQL">
<FilteredTextBlock
  text={PythonCodeExample}
  startMarker="# ===== GET STANDALONE GRAPHQL ====="
  endMarker="# ===== END GET STANDALONE GRAPHQL ====="
  language="graphql"
/>
</TabItem>
</Tabs>

どのような結果が返ってくると思いますか？ 各フィールドを構文と対応させてみてください。

では実際に実行してみましょう。クエリは次のような結果を返します。

<details>
  <summary><i class="fa-solid fa-radar"></i> JSON レスポンスを見る</summary>

```json
{
  "data": {
    "Get": {
      "JeopardyQuestion": [
        {
          "answer": "Amazon.com",
          "question": "On July 16, 1995 this company made its first sale, a science textbook"
        },
        {
          "answer": "Parfait",
          "question": "The French name of this layered ice cream dessert means \"perfect\""
        }
      ]
    }
  }
}
```

</details>

### <i class="fa-solid fa-chalkboard"></i> Weaviate からのレスポンスオブジェクト

上記のとおり、  Weaviate  からのレスポンスは JSON 形式で、結果は `data` フィールドから取得できます。レスポンスはクエリ内容および対象オブジェクトを反映する形で整理されています。

この例では、`Get` フィールドがクエリ関数を、`JeopardyQuestion` フィールドが取得対象クラスを表し、その配下に返却されたオブジェクトが格納されています。各オブジェクトは、要求した `answer` と `question` のプロパティを持ちます。

<details>
  <summary><i class="fa-solid fa-lightbulb"></i> このクエリを解説</summary>

このクエリでは `.with_limit(2)` 引数により 2 件のオブジェクトが返されます。これを指定しない場合、  Weaviate  は設定に応じた最大件数を返します。

:::tip このクエリは便利？
ユーザー固有の検索条件を適用していないため、得られる具体的な結果はそれほど有用でない可能性があります。

しかし、  Weaviate  インスタンスへ接続できるか、データが正しく取り込まれているかなどの「サニティチェック」としては有効です。
:::

</details>

### <i class="fa-solid fa-chalkboard"></i> `Class` と `properties`

上の例では `Class` に `JeopardyQuestion`、`properties` に `question` と `answer` を指定しました。

これは、  Weaviate  内のデータ構造に合わせているため可能です。利用可能なデータクラスとプロパティを確認するには、以下のようにスキーマを確認できます。

<details>
  <summary>スキーマを見るには？</summary>

次のようにしてスキーマを取得できます。試してみてください！

```python
client.schema.get()
```

</details>

import ShortSchema from './_snippets/academy.queries.schema.short.mdx';

<ShortSchema/>

`Class` と `properties` は、  Weaviate  スキーマで定義されたオブジェクトコレクションに対応している必要があります。

`Class` にはデータオブジェクトコレクションの名前を、`properties` には取得したいプロパティのリストを指定します。

スキーマには `JeopardyQuestion` クラスがあり、`question`、`answer`、`points` のプロパティを持っています。

したがって、`JeopardyQuestion` クラスのオブジェクトを取得するクエリでは、`question`、`answer`、`points` のいずれのプロパティも指定できます。

:::note <i class="fa-solid fa-square-terminal"></i> 演習
上記のクエリを再度実行し、次の変更を試してください。  
- `points` プロパティも取得できますか？  
- プロパティを指定しないとどうなりますか？  
:::

:::info 複数のクラスを同時に検索できますか？
いいえ、1 度に検索できるのは 1 クラスのみです。  
<p><br/></p>

各クラスは 1 つの `vector space` を構成しているためです。複数のオブジェクトコレクションを検索したい場合は、複数回検索するか、1 つのクラスにまとめてフィルターで区別する方法をご検討ください。  
<p><br/></p>

このトピックについては、各クラスが独立した `vector space` を構成する意味や、  Weaviate  でスキーマ設計を考える際のポイントを後のユニットで詳しく扱います。
:::

## <i class="fa-solid fa-square-chevron-right"></i> `Get` と `additional` プロパティ

スキーマで定義されていない追加プロパティを取得できます。これらのプロパティはオブジェクトに固有であったり、実行したクエリに関連している場合があります。

### <i class="fa-solid fa-code"></i> 例

この例では、前の例を基に `.with_additional` メソッドを追加しています。

import GetWithAdditional from './_snippets/academy.queries.get.with.additional.mdx';

<GetWithAdditional/>

再度、レスポンスがどのようになるかを考えてみましょう。レスポンスのどこが変わるでしょうか。

では実際に試してみてください。クエリは次のような結果を返すはずです。

<details>
  <summary><i class="fa-solid fa-radar"></i> JSON レスポンスを表示</summary>

```json
{
  "data": {
    "Get": {
      "JeopardyQuestion": [
        {
          "_additional": {
            "distance": 0.1791926,
            "id": "b1645a32-0c22-5814-8f35-58f142eadf7e"
          },
          "answer": "escaping the Earth's gravity (and go off into outer space, on your way to the moon, for instance)",
          "question": "It takes approximately 24,840 MPH to achieve this"
        },
        {
          "_additional": {
            "distance": 0.18123823,
            "id": "ef263438-b152-5540-97f7-99f4076bd124"
          },
          "answer": "the Milky Way",
          "question": "This is the name of our own galaxy"
        }
      ]
    }
  }
}
```

</details>

### <i class="fa-solid fa-chalkboard"></i> Weaviate からのレスポンスオブジェクト

このレスポンスでは、`_additional` フィールドが追加され、その下に `distance` と `id` が入っていることがわかります。

<details>
  <summary><i class="fa-solid fa-lightbulb"></i> クエリの解説</summary>

ここで `distance` と `id` プロパティには、それぞれクエリとの距離とオブジェクトの一意な ID が格納されています。

</details>

### <i class="fa-solid fa-chalkboard"></i> `_additional` プロパティ

名前が示すとおり、`_additional` プロパティはクラスプロパティとして明示的に作成されたものとは別物です。

上記のクエリでは `_additional` フィールドに `distance` プロパティを含めました。これは入力ベクトルとオブジェクトのベクトルとの類似度（この場合は *非類似度*）を表します。

:::info `_additional` で取得できるベクトル

オブジェクトのベクトルも、サブフィールドに `vector` を指定することで `_additional` フィールドから取得できます。

返されるベクトルは多くの場合、非常に長い数値のリストになる点に注意してください。

:::

:::note <i class="fa-solid fa-square-terminal"></i> 演習
上記のクエリを以下の変更を加えて再度試してみましょう。  
- `vector` プロパティも取得できますか？  
- 以前は `.get()` メソッドでメインプロパティに空のリストを渡すとエラーになりました。追加プロパティをリクエストした状態で再度実行するとどうなりますか？
:::

## <i class="fa-solid fa-square-chevron-right"></i> 復習

### <i class="fa-solid fa-pen-to-square"></i> 復習演習

本文中のインライン演習をご覧ください。

### <i class="fa-solid fa-lightbulb-on"></i> 主要ポイント

- `'Get'` 関数を使用して Weaviate からオブジェクトを取得できます。
- `'Get'` 関数の構文では、クラス、プロパティ、および検索条件に関連する追加引数を指定する必要があります。
- Weaviate のレスポンスは JSON 形式です。
- クラスとプロパティのフィールドは、Weaviate スキーマで定義したオブジェクトとプロパティに対応している必要があります。
- `'Get'` クエリでは、スキーマで定義されていない追加プロパティを取得できます。これらはオブジェクトに固有であったり、実行したクエリに関連する場合があります。
- `_additional` プロパティには `distance`、`id`、`vector` などが含まれ、取得したオブジェクトに関するさらなる文脈と情報を提供します。

import Quiz from '/src/components/Academy/quiz.js'
export const nearText = [{
  questionText: 'questionText',
  answerOptions: [
    {
      answerText: 'answerOne',
      isCorrect: false,
      feedback: 'feedbackOne',
    },
    {
      answerText: 'answerTwo',
      isCorrect: false,
      feedback: 'feedbackTwo',
    },
    {
      answerText: 'answerThree',
      isCorrect: false,
      feedback: 'feedbackThree',
    },
  ]
}];

## 質問とフィードバック

import DocsFeedback from '/_includes/docs-feedback.mdx';

<DocsFeedback/>