---
title: "概要"
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import FilteredTextBlock from '@site/src/components/Documentation/FilteredTextBlock';
import PyCode from '!!raw-loader!./_snippets/100_config.py';

Weaviate におけるマルチテナンシーは、コレクションが分離されたデータグループを効率的に提供できるようにする機能です。マルチテナント コレクション内の各「テナント」は、自身のデータのみにアクセスでき、同じデータ構造と設定を共有します。

![マルチテナンシー](./img/multi-tenancy-dark.png#gh-dark-mode-only)
![マルチテナンシー](./img/multi-tenancy-light.png#gh-light-mode-only)

これにより、Weaviate は最小限のオーバーヘッドで多数のテナントを効率的に処理できます。後ほど説明するように、個々のテナントを管理してパフォーマンスとリソース使用量のバランスを取ることも可能です。

<details>
  <summary>他の文脈における「マルチテナンシー」</summary>

一般に「マルチテナンシー」とは、単一のソフトウェア インスタンスが複数の「テナント」を提供するソフトウェア アーキテクチャを指します。この場合、各テナントは共通アクセス権を持つユーザーグループであることが多いです。

これは Weaviate におけるマルチテナンシーの概念と似ており、各テナントは他のテナントから分離されたデータグループとして扱われます。

</details>

## <i class="fa-solid fa-square-chevron-right"></i> マルチテナンシー使用の理由

典型的なユースケースとして、SaaS (software-as-a-service) アプリケーションがあります。多くの SaaS アプリケーションでは、各エンドユーザーやアカウントが持つプライベート データは他者からアクセスできない必要があります。

### <i class="fa-solid fa-chalkboard"></i> ケーススタディの例

このコースでは、`MyPrivateJournal` というアプリを開発する立場になり、マルチテナンシーについて学んでいきます。

`MyPrivateJournal` は SaaS アプリケーションで、*Steve*、*Alice* などのユーザーが日記を作成・保存できます。各ユーザーの日記はプライベートで、他者が閲覧できてはいけません。

単一テナント コレクションでこれを実装すると、次のいずれかになります。

1. **モノリシック コレクション**: すべてのデータセットをエンドユーザー識別子プロパティ付きで 1 つのコレクションに保存  
1. **ユーザーごとのコレクション**: 各エンドユーザーのデータを個別のコレクションに保存  

しかし、どちらにも大きな制限があります。

- モノリシック コレクションの場合:  
    - 開発者のミスで *Steve* の日記が *Alice* に漏れるなど、重大なプライバシー侵害が起こり得ます。  
    - `MyPrivateJournal` が成長すると、*Steve* のクエリはコレクション全体を検索するため遅くなります。  
    - *Steve* が `MyPrivateJournal` にデータ削除を依頼した場合、処理が複雑でエラーが起きやすくなります。  
- ユーザーごとのコレクションの場合:  
    - `MyPrivateJournal` は大量のコレクションを支えるため、より多くのハードウェアコストがかかります。  
    - 設定変更 (例: 新しいプロパティの追加) を行う際、各コレクションごとに個別対応が必要です。  

Weaviate のマルチテナンシーは、同一設定を共有しながらユーザーデータを分離することで、これらの問題を解決します。

### <i class="fa-solid fa-chalkboard"></i> マルチテナンシーの利点

マルチテナント コレクションでは、各「テナント」が相互に分離されつつ、同じ設定を共有します。この構成により、多数の単一テナント コレクションを作るよりもはるかにリソース効率が高くなります。

1 つの Weaviate ノードは、単一テナント コレクションよりも多くのテナントをホストできます。また、設定が 1 つで済むため開発者の負担も軽減され、テナント間のデータ漏えいリスクがなく、各テナントやデータの管理が容易になります。

#### `MyPrivateJournal` とマルチテナンシー

`MyPrivateJournal` はマルチテナンシーを利用し、各ユーザーの日記を個別のテナントに保存できます。これにより *Steve* と *Alice* のデータが互いに分離され、管理も安全になります。

さらに、`MyPrivateJournal` はアクティブでないユーザーのデータをコールド ストレージへ移動し、Weaviate ノードのホット (メモリ) およびウォーム (ディスク) リソース使用量を低減できます。

## <i class="fa-solid fa-square-chevron-right"></i> テナントとコレクションの比較

マルチテナント コレクションには、任意の数のテナントを作成できます。

| 対象 | テナント | 単一テナント コレクション |
| ----- | ----- | ----- |
| オブジェクト | テナントに属する | コレクションに属する |
| ベクトルインデックス | テナントに属する | コレクションに属する |
| 転置インデックス | テナントに属する | コレクションに属する |
| 削除 | テナントを削除するとそのテナントのデータが削除される | コレクションを削除するとそのコレクションのデータが削除される |
| クエリ | 1 度に 1 つのテナントを検索できる | 1 度に 1 つのコレクションを検索できる |

もちろん、違いもあります。次のセクションでは、`MyPrivateJournal` が Weaviate でマルチテナンシーを実装する流れに沿って、これらの違いを確認していきます。

## 質問とフィードバック

import DocsFeedback from '/_includes/docs-feedback.mdx';

<DocsFeedback/>