---
title: キーワード & ハイブリッド検索
description: マルチモーダルコレクションでのハイブリッドキーワード検索
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import FilteredTextBlock from '@site/src/components/Documentation/FilteredTextBlock';
import TSCode from '!!raw-loader!../_snippets/103_searches.mts';

キーワード（ BM25 ）検索を実行してキーワード類似度に基づいてアイテムを検索したり、BM25 とセマンティック / ベクトル検索を組み合わせたハイブリッド検索を行うこともできます。

## <i class="fa-solid fa-square-chevron-right"></i> キーワード検索

### <i class="fa-solid fa-code"></i> コード

この例では、「Movie」クラス内で「history」という語に対してキーワード検索スコアが最も高いエントリを取得し、上位 5 件のタイトルと公開年を出力します。

<FilteredTextBlock
  text={TSCode}
  startMarker="// MetadataBM25Search"
  endMarker="// END MetadataBM25Search"
  language="ts"
/>

### <i class="fa-solid fa-chalkboard"></i> コードの説明

結果は、キーワード検索スコアである BM25f アルゴリズムに基づいています。

`limit` パラメーターは、返される結果の最大数を設定します。

`returnMetadata` パラメーターは、検索結果で返すメタデータを設定する文字列の配列を受け取ります。現在のクエリでは、結果の BM25 スコアである `score` を返します。

<details>
  <summary>結果例</summary>

```text
American History X 1998
BM25 score: 2.707

A Beautiful Mind 2001
BM25 score: 1.896

Legends of the Fall 1994
BM25 score: 1.663

Hacksaw Ridge 2016
BM25 score: 1.554

Night at the Museum 2006
BM25 score: 1.529
```

</details>


## <i class="fa-solid fa-square-chevron-right"></i> ハイブリッド検索

### <i class="fa-solid fa-code"></i> コード

この例では、「Movie」クラス内で「history」という語に対してハイブリッド検索スコアが最も高いエントリを取得し、上位 5 件のタイトルと公開年を出力します。

<FilteredTextBlock
  text={TSCode}
  startMarker="// MetadataHybridSearch"
  endMarker="// END MetadataHybridSearch"
  language="ts"
/>

### <i class="fa-solid fa-chalkboard"></i> コードの説明

結果はハイブリッド検索スコアに基づいています。ハイブリッド検索は、BM25 とセマンティック / ベクトル検索の結果をブレンドします。

`limit` パラメーターは、返される結果の最大数を設定します。

`returnMetadata` パラメーターは、検索結果で返すメタデータを設定する文字列の配列を受け取ります。現在のクエリでは、結果のハイブリッドスコアである `score` を返します。

<details>
  <summary>結果例</summary>

```text
Legends of the Fall 1994
Hybrid score: 0.016

Hacksaw Ridge 2016
Hybrid score: 0.016

A Beautiful Mind 2001
Hybrid score: 0.015

The Butterfly Effect 2004
Hybrid score: 0.015

Night at the Museum 2006
Hybrid score: 0.012
```

</details>


## ご質問・フィードバック

import DocsFeedback from '/_includes/docs-feedback.mdx';

<DocsFeedback/>