---
title: マルチモーダル検索
description: マルチモーダル検索の方法論
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import FilteredTextBlock from '@site/src/components/Documentation/FilteredTextBlock';
import TSCode from '!!raw-loader!../_snippets/103_searches.mts';

Weaviate を使用すると、アイテムの意味に基づいて類似アイテムを見つけるセマンティック検索を実行できます。これは、データベース内のアイテムの ベクトル 埋め込みを比較することで行われます。

マルチモーダルモデルを使用しているため、サポートされている任意のモダリティとの類似度に基づいてオブジェクトを検索できます。つまり、テキストや画像との類似度をもとに映画を検索することが可能です。

## <i class="fa-solid fa-square-chevron-right"></i> 画像クエリ

### <i class="fa-solid fa-code"></i> コード

この例では、「Movie」から [国際宇宙ステーションのこの画像](https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/International_Space_Station_after_undocking_of_STS-132.jpg/440px-International_Space_Station_after_undocking_of_STS-132.jpg) との類似度に基づいてエントリを検索し、上位 5 件のタイトルと公開年を出力します。

<details>
  <summary>クエリ画像</summary>

![International Space Station](https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/International_Space_Station_after_undocking_of_STS-132.jpg/440px-International_Space_Station_after_undocking_of_STS-132.jpg)

</details>

<FilteredTextBlock
  text={TSCode}
  startMarker="// MetadataMultimodalSearch"
  endMarker="// END MetadataMultimodalSearch"
  language="ts"
/>

### <i class="fa-solid fa-chalkboard"></i> コードの解説

結果は、クエリとデータベースオブジェクト間の ベクトル 埋め込みの類似度に基づいています。この場合、ベクトライザー モジュールが入力画像の埋め込みを生成します。

`limit` パラメーターは、返される結果の最大数を設定します。

`returnMetadata` パラメーターは、検索結果に含めるメタデータを文字列配列で指定します。このクエリでは、クエリとの ベクトル 距離を返します。


<details>
  <summary>結果例</summary>

上位 5 件のポスター:
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/157336_poster.jpg" alt="Interstellar" width="200" />
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/49047_poster.jpg" alt="Gravity" width="200" />
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/329865_poster.jpg" alt="Arrival" width="200" />
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/95_poster.jpg" alt="Armageddon" width="200" />
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/929_poster.jpg" alt="Godzilla" width="200" />

Weaviate の出力:

```text
Interstellar 2014 157336
Distance to query: 0.354

Gravity 2013 49047
Distance to query: 0.384

Arrival 2016 329865
Distance to query: 0.386

Armageddon 1998 95
Distance to query: 0.400

Godzilla 1998 929
Distance to query: 0.441
```

</details>

### <i class="fa-solid fa-chalkboard"></i> レスポンスオブジェクト

返されるオブジェクトはカスタムクラスのインスタンスです。その `objects` 属性は検索結果のリストで、各オブジェクトも別のカスタムクラスのインスタンスです。

各オブジェクトは次のとおりです:
- BLOB データ型を除くすべてのプロパティと UUID がデフォルトで含まれます。
    - `poster` プロパティは BLOB のため、デフォルトでは含まれません。
    - `poster` を含めるには、他の取得したいプロパティとともに `returnProperties` パラメーターで指定する必要があります。
- 参照、メタデータ、 ベクトル など、その他の情報はデフォルトでは含まれません。


## <i class="fa-solid fa-square-chevron-right"></i> テキスト検索

### <i class="fa-solid fa-code"></i> コード

この例では、「Movie」からクエリ「red」との類似度に基づいてエントリを検索し、上位 5 件のタイトルと公開年を出力します。

<FilteredTextBlock
  text={TSCode}
  startMarker="// MetadataSemanticSearch"
  endMarker="// END MetadataSemanticSearch"
  language="ts"
/>

### <i class="fa-solid fa-chalkboard"></i> コードの解説

結果は、クエリとデータベースオブジェクト間の ベクトル 埋め込みの類似度に基づいています。この場合、ベクトライザー モジュールが入力テキストの埋め込みを生成します。

その他のパラメーターは前の例と同じです。

<details>
  <summary>結果例</summary>

上位 5 件のポスター:
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/383498_poster.jpg" alt="Deadpool 2" width="200" />
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/338762_poster.jpg" alt="Bloodshot" width="200" />
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/293660_poster.jpg" alt="Deadpool" width="200" />
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/1271_poster.jpg" alt="300" width="200" />
<img src="https://raw.githubusercontent.com/weaviate-tutorials/edu-datasets/main/posters/1669_poster.jpg" alt="The Hunt for Red October" width="200" />

Weaviate の出力:

```text
Deadpool 2 2018 383498
Distance to query: 0.670

Bloodshot 2020 338762
Distance to query: 0.677

Deadpool 2016 293660
Distance to query: 0.678

300 2007 1271
Distance to query: 0.682

The Hunt for Red October 1990 1669
Distance to query: 0.683
```

</details>

### <i class="fa-solid fa-chalkboard"></i> レスポンスオブジェクト

返されるオブジェクトの形式は前の例と同じです。


## 質問とフィードバック

import DocsFeedback from '/_includes/docs-feedback.mdx';

<DocsFeedback/>